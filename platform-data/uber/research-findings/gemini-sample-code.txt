<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Rideshare Strategizer</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <!-- Chosen Palette: "Global Asphalt" -->
    <!-- Background: #f8fafc (Slate 50) -->
    <!-- Primary Text: #0f172a (Slate 900) -->
    <!-- Accent Brand: #000000 (Black - Neutral for Uber/Lyft) -->
    <!-- Functional Colors: Emerald (Profit), Rose (Danger), Amber (Caution) -->

    <!-- Application Structure Plan:
         1. Global Configuration: Top bar to select "Market Archetype" (Sprawl, Dense, Party, College). This sets the global state.
         2. The Rhythm (Time): Hourly charts that update based on the Archetype.
         3. The Zones (Geography): Abstracted zone cards (Airport, Core, Suburb) with universal rules.
         4. The Calculator (Math): A numeric input tool to calculate profitability of ANY long trip.
         5. The Strategy (Logic): Long vs Short toggles adapted for general principles.
         Why this structure? It moves from "Macro" (City Type) to "Micro" (Specific Trip Decision), teaching the user *how* to fish in any pond.
    -->

    <!-- Visualization & Content Choices:
         1. Demand Chart (Bar): Updates dynamically based on Market Archetype selection.
         2. Radar Chart (Radar): Compares Vehicle Classes (X, XL, Lux) on universal metrics.
         3. Calculator (Input Form): Replaces the static city list with a functional tool for any market.
         4. Zone Grid (CSS Grid): visualizes abstract zones.
         5. NO SVG/Mermaid: All icons are Unicode/CSS.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #0f172a;
        }

        /* Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Interactive Elements */
        .archetype-btn {
            transition: all 0.2s ease;
        }
        .archetype-btn:hover {
            border-color: #0f172a;
        }
        .archetype-btn.active {
            background-color: #0f172a;
            color: white;
            border-color: #0f172a;
        }

        .day-btn.active {
            background-color: #0f172a;
            color: #ffffff;
        }

        .zone-card {
            transition: transform 0.2s;
        }
        .zone-card:hover {
            transform: translateY(-4px);
        }
        .zone-card.active {
            ring: 2px solid #0f172a;
        }

        /* Calculator Animation */
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-slide {
            animation: slideDown 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <!-- Navigation & Market Selector -->
    <header class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="py-4">
                <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                    <div class="flex items-center">
                        <span class="text-3xl mr-3">üåê</span>
                        <div>
                            <h1 class="text-xl font-bold tracking-tight text-slate-900 leading-tight">Universal Rideshare Strategizer</h1>
                            <p class="text-xs text-slate-500 font-medium">Master Any Market: Uber & Lyft Logic</p>
                        </div>
                    </div>

                    <!-- Market Archetype Selector -->
                    <div class="flex bg-slate-100 p-1 rounded-lg overflow-x-auto">
                        <button onclick="setArchetype('sprawl')" id="arch-sprawl" class="archetype-btn active px-4 py-2 rounded-md text-sm font-semibold whitespace-nowrap">Sprawl City</button>
                        <button onclick="setArchetype('dense')" id="arch-dense" class="archetype-btn px-4 py-2 rounded-md text-sm font-semibold text-slate-600 whitespace-nowrap">Dense Metro</button>
                        <button onclick="setArchetype('party')" id="arch-party" class="archetype-btn px-4 py-2 rounded-md text-sm font-semibold text-slate-600 whitespace-nowrap">Tourism/Party</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

        <!-- Context & Intro -->
        <section class="mb-12">
            <div class="bg-slate-900 rounded-2xl p-6 md:p-8 text-white shadow-xl">
                <h2 class="text-2xl md:text-3xl font-bold mb-3">The Physics of Rideshare</h2>
                <p class="text-slate-300 max-w-3xl text-lg leading-relaxed">
                    Every market is different, but the rules of profitability are universal. 
                    You have selected <span id="current-arch-name" class="font-bold text-white border-b-2 border-emerald-500">Sprawl City</span> (e.g., Dallas, LA, Phoenix). 
                    <span id="current-arch-desc" class="block mt-2 text-emerald-300 text-sm font-medium">
                        Characterized by high mileage, car dependency, and morning airport rushes. Speed is high, but deadhead risk is extreme.
                    </span>
                </p>
            </div>
        </section>

        <!-- SECTION 1: MARKET RHYTHM -->
        <section id="rhythm" class="mb-16">
            <div class="flex items-center justify-between border-b border-slate-200 pb-4 mb-6">
                <div>
                    <h3 class="text-2xl font-bold text-slate-900">Market Rhythm & Demand</h3>
                    <p class="mt-1 text-slate-600 text-sm">When to drive based on your market type.</p>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Day Controls -->
                <div class="lg:col-span-1 space-y-4">
                    <label class="block text-xs font-bold text-slate-400 uppercase tracking-wider">Select Day of Week</label>
                    <div class="grid grid-cols-4 gap-2">
                        <button onclick="updateDay('Mon')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors active" id="btn-Mon">MON</button>
                        <button onclick="updateDay('Tue')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Tue">TUE</button>
                        <button onclick="updateDay('Wed')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Wed">WED</button>
                        <button onclick="updateDay('Thu')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Thu">THU</button>
                        <button onclick="updateDay('Fri')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Fri">FRI</button>
                        <button onclick="updateDay('Sat')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Sat">SAT</button>
                        <button onclick="updateDay('Sun')" class="day-btn px-3 py-2 rounded border border-slate-200 hover:bg-slate-50 text-sm font-bold transition-colors" id="btn-Sun">SUN</button>
                    </div>

                    <div class="bg-white border-l-4 border-emerald-500 p-5 rounded shadow-sm">
                        <h4 class="font-bold text-slate-900 mb-2" id="insight-title">Monday Strategy</h4>
                        <p class="text-sm text-slate-600 leading-relaxed" id="insight-text">
                            <!-- JS Populated -->
                        </p>
                    </div>
                </div>

                <!-- Chart -->
                <div class="lg:col-span-2 bg-white p-4 rounded-xl shadow-sm border border-slate-200">
                    <div class="chart-container">
                        <canvas id="demandChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 2: UNIVERSAL ZONE LOGIC -->
        <section id="zones" class="mb-16">
            <div class="border-b border-slate-200 pb-4 mb-6">
                <h3 class="text-2xl font-bold text-slate-900">Universal Zone Logic</h3>
                <p class="mt-1 text-slate-600 text-sm">Every market has these four zones. Identify them in your city to master positioning.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <!-- Zone 1: The Wealthy Suburbs -->
                <div onclick="selectZone('suburb')" class="zone-card cursor-pointer bg-white border border-slate-200 p-6 rounded-xl hover:shadow-md group">
                    <div class="text-3xl mb-3 group-hover:scale-110 transition-transform duration-200">üè°</div>
                    <h4 class="font-bold text-slate-900">The Wealthy Suburbs</h4>
                    <p class="text-xs text-slate-500 mt-2">Frisco, Santa Monica, Greenwich, Naperville.</p>
                </div>

                <!-- Zone 2: The Core -->
                <div onclick="selectZone('core')" class="zone-card cursor-pointer bg-white border border-slate-200 p-6 rounded-xl hover:shadow-md group">
                    <div class="text-3xl mb-3 group-hover:scale-110 transition-transform duration-200">üèôÔ∏è</div>
                    <h4 class="font-bold text-slate-900">The Business Core</h4>
                    <p class="text-xs text-slate-500 mt-2">Downtown, Financial District, Tech Hubs.</p>
                </div>

                <!-- Zone 3: The Airport -->
                <div onclick="selectZone('airport')" class="zone-card cursor-pointer bg-white border border-slate-200 p-6 rounded-xl hover:shadow-md group">
                    <div class="text-3xl mb-3 group-hover:scale-110 transition-transform duration-200">‚úàÔ∏è</div>
                    <h4 class="font-bold text-slate-900">The Airport</h4>
                    <p class="text-xs text-slate-500 mt-2">Major International Hubs.</p>
                </div>

                <!-- Zone 4: The Void -->
                <div onclick="selectZone('void')" class="zone-card cursor-pointer bg-white border border-slate-200 p-6 rounded-xl hover:shadow-md group">
                    <div class="text-3xl mb-3 group-hover:scale-110 transition-transform duration-200">üèúÔ∏è</div>
                    <h4 class="font-bold text-slate-900">The Dead Zone</h4>
                    <p class="text-xs text-slate-500 mt-2">Rural areas, exurbs, low density.</p>
                </div>
            </div>

            <!-- Dynamic Zone Advice -->
            <div id="zone-detail-panel" class="mt-6 bg-slate-50 border border-slate-200 rounded-xl p-6">
                <div class="flex items-start">
                    <div class="mr-4 mt-1 text-2xl" id="zone-icon-display">‚ÑπÔ∏è</div>
                    <div>
                        <h4 class="text-lg font-bold text-slate-900" id="zone-title-display">Select a Zone Above</h4>
                        <div class="mt-2 text-slate-600 text-sm leading-relaxed space-y-2" id="zone-body-display">
                            <p>Click on one of the card types above to learn the universal rules for that environment.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: UNIVERSAL CALCULATOR -->
        <section id="calculator" class="mb-16">
            <div class="bg-white rounded-2xl shadow-lg border border-slate-200 overflow-hidden">
                <div class="bg-black p-6 text-white md:flex justify-between items-center">
                    <div>
                        <h3 class="text-2xl font-bold">üßÆ Deadhead Risk Calculator</h3>
                        <p class="text-gray-400 text-sm mt-1">Universal Logic: Should I take this long trip?</p>
                    </div>
                </div>

                <div class="p-6 md:p-8 grid grid-cols-1 md:grid-cols-2 gap-12">
                    <!-- Inputs -->
                    <div class="space-y-6">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Trip Duration (Minutes)</label>
                            <input type="range" id="trip-time" min="15" max="180" value="45" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-black" oninput="updateCalcDisplay()">
                            <div class="flex justify-between text-xs text-slate-400 mt-1">
                                <span>15m</span>
                                <span id="time-display" class="font-bold text-slate-900 text-base">45 mins</span>
                                <span>3h</span>
                            </div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Destination Type</label>
                            <select id="dest-type" class="w-full p-3 border border-slate-300 rounded-lg bg-white text-slate-900 text-sm font-medium focus:ring-2 focus:ring-black focus:border-black outline-none">
                                <option value="city">Another City/Busy Area (High Return Chance)</option>
                                <option value="suburb">Suburb (Low Return Chance)</option>
                                <option value="rural">Rural/Casino/Nowhere (Zero Return Chance)</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Current Surge / Bonus?</label>
                            <select id="surge-level" class="w-full p-3 border border-slate-300 rounded-lg bg-white text-slate-900 text-sm font-medium focus:ring-2 focus:ring-black focus:border-black outline-none">
                                <option value="1">Base Fare (No Surge)</option>
                                <option value="1.5">Small Surge/Boost (1.5x)</option>
                                <option value="2.5">High Surge (2.0x+)</option>
                            </select>
                        </div>

                        <button onclick="calculateRisk()" class="w-full bg-black text-white font-bold py-4 rounded-lg hover:bg-slate-800 transition-colors shadow-lg">
                            Analyze Trip
                        </button>
                    </div>

                    <!-- Output -->
                    <div class="flex items-center justify-center bg-slate-50 rounded-xl border-2 border-dashed border-slate-200 p-6 relative">
                        <div id="calc-placeholder" class="text-center text-slate-400">
                            <span class="text-4xl block mb-2">üëá</span>
                            Enter details & click Analyze
                        </div>

                        <div id="calc-result" class="hidden w-full h-full flex-col justify-center result-slide">
                            <div class="text-center mb-6">
                                <span id="verdict-icon" class="text-5xl block mb-2">üõë</span>
                                <h4 class="text-3xl font-black text-slate-900" id="verdict-title">DECLINE</h4>
                            </div>

                            <div class="space-y-3">
                                <div class="flex justify-between text-sm border-b border-slate-200 pb-2">
                                    <span class="text-slate-500">Estimated Earnings</span>
                                    <span class="font-bold text-emerald-600" id="est-earnings">$0.00</span>
                                </div>
                                <div class="flex justify-between text-sm border-b border-slate-200 pb-2">
                                    <span class="text-slate-500">Unpaid Return (Deadhead)</span>
                                    <span class="font-bold text-rose-600" id="est-deadhead">0 mins</span>
                                </div>
                                <div class="flex justify-between text-sm pt-1">
                                    <span class="text-slate-500 font-bold">Effective Hourly Rate</span>
                                    <span class="font-black text-slate-900" id="est-hourly">$0/hr</span>
                                </div>
                            </div>

                            <p id="verdict-reason" class="mt-6 text-xs text-center text-slate-500 italic leading-relaxed">
                                Analysis reason text.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- SECTION 4: STRATEGIC PRINCIPLES -->
        <section class="mb-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Short Game -->
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                    <div class="flex items-center mb-4">
                        <span class="bg-blue-100 text-blue-700 p-2 rounded-lg text-xl mr-3">‚ö°</span>
                        <h3 class="text-xl font-bold text-slate-900">The "Ant" Strategy</h3>
                    </div>
                    <p class="text-sm text-slate-600 mb-4 font-medium">Best for Dense Metros & Weekend Quests</p>
                    <ul class="space-y-2 text-sm text-slate-600">
                        <li class="flex items-start"><span class="mr-2 text-blue-500">‚úì</span>Accept everything under 15 mins.</li>
                        <li class="flex items-start"><span class="mr-2 text-blue-500">‚úì</span>Stay in the high-density core.</li>
                        <li class="flex items-start"><span class="mr-2 text-blue-500">‚úì</span>Turn on "Stop New Requests" during rides to prevent being dragged out of the zone.</li>
                        <li class="flex items-start"><span class="mr-2 text-blue-500">‚úì</span>Goal: Volume (3-4 rides/hr).</li>
                    </ul>
                </div>

                <!-- Long Game -->
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
                    <div class="flex items-center mb-4">
                        <span class="bg-emerald-100 text-emerald-700 p-2 rounded-lg text-xl mr-3">üéØ</span>
                        <h3 class="text-xl font-bold text-slate-900">The "Sniper" Strategy</h3>
                    </div>
                    <p class="text-sm text-slate-600 mb-4 font-medium">Best for Sprawl Cities & Airports</p>
                    <ul class="space-y-2 text-sm text-slate-600">
                        <li class="flex items-start"><span class="mr-2 text-emerald-500">‚úì</span>Decline short trips (under $10).</li>
                        <li class="flex items-start"><span class="mr-2 text-emerald-500">‚úì</span>Position in wealthy suburbs at 4:00 AM.</li>
                        <li class="flex items-start"><span class="mr-2 text-emerald-500">‚úì</span>Use Destination Filters aggressively to return to the hub.</li>
                        <li class="flex items-start"><span class="mr-2 text-emerald-500">‚úì</span>Goal: High $/Mile, low stress.</li>
                    </ul>
                </div>
            </div>
        </section>

    </main>

    <footer class="bg-white border-t border-slate-200 mt-8 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 text-sm font-medium">Universal Rideshare Strategizer &copy; 2025</p>
            <p class="text-slate-400 text-xs mt-2 max-w-lg mx-auto">This tool provides strategic frameworks based on general market economics. Always adapt to your specific local conditions, traffic, and safety regulations.</p>
        </div>
    </footer>

    <!-- LOGIC -->
    <script>
        // --- STATE MANAGEMENT ---
        let currentArchetype = 'sprawl'; // Default
        let currentDay = 'Mon';

        // --- DATA SETS ---

        // 1. Demand Data by Archetype
        const demandData = {
            'sprawl': {
                // Early morning Airport rush, dead mid-day, PM commute
                'Mon': [5, 10, 20, 50, 90, 80, 50, 40, 30, 20, 20, 30, 40, 40, 50, 70, 80, 60, 40, 30, 20, 10, 5, 5], 
                'Fri': [10, 20, 30, 40, 60, 50, 40, 40, 40, 40, 50, 60, 70, 80, 90, 100, 95, 90, 90, 95, 90, 70, 50, 30],
                'Sat': [20, 10, 5, 5, 10, 20, 30, 40, 50, 60, 70, 75, 70, 65, 70, 80, 90, 95, 100, 100, 100, 100, 90, 60],
                insight: {
                    'Mon': "Sprawl City Monday: 4AM-8AM is strictly Airport runs from Suburbs. 5PM is commute. Avoid mid-day.",
                    'Fri': "The Grind: Commuters AM, Airport Mid-day, Nightlife PM. Stay mobile.",
                    'Sat': "Errands all day, Party all night. Expect long pickups in suburbs."
                }
            },
            'dense': {
                // Consistent high demand, less AM spike, huge PM/Night
                'Mon': [20, 15, 10, 10, 30, 50, 70, 85, 80, 70, 65, 70, 75, 70, 75, 85, 90, 85, 70, 60, 50, 40, 30, 20],
                'Fri': [30, 20, 15, 15, 20, 30, 50, 70, 75, 70, 70, 75, 80, 85, 90, 95, 100, 100, 100, 100, 100, 95, 80, 60],
                'Sat': [50, 40, 30, 20, 15, 15, 20, 30, 40, 60, 80, 90, 95, 90, 90, 95, 100, 100, 100, 100, 100, 100, 95, 80],
                insight: {
                    'Mon': "Dense Metro Monday: Business travel and office commutes. Constant short trips.",
                    'Fri': "Gridlock Alert: 3PM-7PM is high surge but 0mph traffic. Use 'Stop Requests' to stay in zone.",
                    'Sat': "Non-stop demand. Focus on short trips to hit Quest bonuses quickly."
                }
            },
            'party': {
                // Dead mornings, massive late night spikes
                'Mon': [30, 10, 5, 5, 10, 20, 30, 30, 20, 15, 15, 20, 25, 30, 30, 40, 50, 50, 40, 30, 20, 10, 10, 5],
                'Fri': [20, 10, 5, 5, 5, 10, 20, 30, 40, 50, 60, 70, 80, 85, 90, 90, 95, 95, 100, 100, 100, 100, 90, 80],
                'Sat': [70, 50, 30, 10, 5, 5, 10, 20, 30, 50, 70, 80, 90, 90, 90, 95, 95, 100, 100, 100, 100, 100, 100, 90],
                insight: {
                    'Mon': "Recovery Day. Very slow. Only airport departures are viable.",
                    'Fri': "Tourist Arrivals. 11AM-4PM Airport pickups. 9PM+ Nightlife.",
                    'Sat': "The Main Event. Sleep in. Drive 4PM - 4AM. Prepare for drunk passengers."
                }
            }
        };

        // 2. Zone Logic
        const zoneContent = {
            'suburb': {
                title: 'The Wealthy Suburbs',
                icon: 'üè°',
                body: '<p class="font-bold text-emerald-600">Best Time: 4:00 AM - 8:00 AM</p><p><strong>Goal:</strong> Catch the "Unicorn" airport run (45+ mins).</p><p><strong>Rule:</strong> Do not drive here mid-day or evening. You will wait 20 mins for a $5 grocery store run. If you end up here after 9am, set a Destination Filter back to the Core immediately.</p>'
            },
            'core': {
                title: 'The Business Core',
                icon: 'üèôÔ∏è',
                body: '<p class="font-bold text-blue-600">Best Time: Weekdays 7AM-7PM & Weekend Nights</p><p><strong>Goal:</strong> Volume. Short, fast trips.</p><p><strong>Rule:</strong> Know your one-way streets. Avoid during massive events unless surge is >$10. This is where you grind out ride counts for bonuses.</p>'
            },
            'airport': {
                title: 'The Airport Hub',
                icon: '‚úàÔ∏è',
                body: '<p class="font-bold text-purple-600">Best Time: Sunday PM (Arrivals) / Monday AM (Departures)</p><p><strong>Goal:</strong> Rematch (Instant Pickup).</p><p><strong>Rule:</strong> <span class="text-rose-600 font-bold">Never wait in the queue if it has 50+ cars.</span> It is a math trap. Only drop off passengers and fish for an instant "Rematch" ping. If no ping in 2 mins, leave.</p>'
            },
            'void': {
                title: 'The Dead Zone (Rural/Exurbs)',
                icon: 'üèúÔ∏è',
                body: '<p class="font-bold text-rose-600">Best Time: NEVER.</p><p><strong>Goal:</strong> Escape.</p><p><strong>Rule:</strong> If a ride takes you here, you must factor in the "Deadhead" return. Do not accept a 45 min ride to a rural town unless it pays 2.0x surge, because you will drive 45 mins back for free.</p>'
            }
        };

        // --- FUNCTIONS ---

        // 1. Chart Initialization
        const ctx = document.getElementById('demandChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['12a','1','2','3','4','5','6','7','8','9','10','11','12p','1','2','3','4','5','6','7','8','9','10','11'],
                datasets: [{
                    label: 'Demand Score',
                    data: demandData['sprawl']['Mon'],
                    backgroundColor: '#0f172a',
                    borderRadius: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { 
                    y: { display: false, max: 100 }, 
                    x: { grid: { display: false } } 
                }
            }
        });

        // 2. Market Archetype Switcher
        function setArchetype(type) {
            currentArchetype = type;

            // UI Updates
            document.querySelectorAll('.archetype-btn').forEach(btn => btn.classList.remove('active', 'bg-slate-900', 'text-white'));
            document.getElementById(`arch-${type}`).classList.add('active');

            // Text Updates
            const nameEl = document.getElementById('current-arch-name');
            const descEl = document.getElementById('current-arch-desc');

            if(type === 'sprawl') {
                nameEl.innerText = "Sprawl City";
                descEl.innerText = "High mileage, car dependency. Focus on AM Airport runs and avoiding dead miles.";
            } else if(type === 'dense') {
                nameEl.innerText = "Dense Metro";
                descEl.innerText = "Short trips, high traffic. Focus on Quests/Bonuses and stay in the core.";
            } else {
                nameEl.innerText = "Tourism/Party Hub";
                descEl.innerText = "Extreme peaks. Sleep all day, drive all night. Focus on events and safety.";
            }

            // Update Chart
            updateDay(currentDay);
        }

        // 3. Day Switcher
        function updateDay(day) {
            currentDay = day;

            // UI
            document.querySelectorAll('.day-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-slate-900', 'text-white');
                btn.classList.add('bg-white', 'text-slate-900');
            });
            document.getElementById(`btn-${day}`).classList.add('active', 'bg-slate-900', 'text-white');

            // Data Fetch (Fallback to Fri/Sat logic if generic day)
            let dataKey = day;
            if (['Tue', 'Wed', 'Thu'].includes(day)) dataKey = 'Mon'; // Simplified weekday logic
            if (day === 'Sun') dataKey = 'Mon'; // Simplified

            // Actually, let's use the specific if available, or fall back
            let dataSeries = demandData[currentArchetype][day] || demandData[currentArchetype]['Mon'];
            let insightText = demandData[currentArchetype].insight[day] || "Standard weekday logic applies. Focus on commute hours.";

            // Specific overrides for simplicity in demo
            if(day === 'Sat') {
                dataSeries = demandData[currentArchetype]['Sat'];
                insightText = demandData[currentArchetype].insight['Sat'];
            } else if (day === 'Fri') {
                dataSeries = demandData[currentArchetype]['Fri'];
                insightText = demandData[currentArchetype].insight['Fri'];
            }

            document.getElementById('insight-title').innerText = `${day} Strategy`;
            document.getElementById('insight-text').innerText = insightText;

            chart.data.datasets[0].data = dataSeries;
            chart.update();
        }

        // 4. Zone Selection
        function selectZone(zone) {
            const data = zoneContent[zone];
            document.getElementById('zone-title-display').innerText = data.title;
            document.getElementById('zone-icon-display').innerText = data.icon;
            document.getElementById('zone-body-display').innerHTML = data.body;

            document.querySelectorAll('.zone-card').forEach(card => card.classList.remove('active'));
            // Visual feedback handling simpler via CSS hover, but could add active class here if needed
        }

        // 5. Calculator Logic
        function updateCalcDisplay() {
            const val = document.getElementById('trip-time').value;
            document.getElementById('time-display').innerText = `${val} mins`;
        }

        function calculateRisk() {
            const time = parseInt(document.getElementById('trip-time').value);
            const destType = document.getElementById('dest-type').value;
            const surge = parseFloat(document.getElementById('surge-level').value);

            // Assumptions for logic
            // Base Pay: $0.60/min (blend of time/mile for simplicity)
            // Deadhead Speed: 1 min driving = 1 min return if rural

            let baseEarnings = time * 0.80; // Roughly $0.80/min avg gross in varied markets
            let totalEarnings = baseEarnings * surge;

            let deadheadTime = 0;
            if (destType === 'rural') deadheadTime = time; // Full return
            else if (destType === 'suburb') deadheadTime = time * 0.5; // Half return to civilization
            else deadheadTime = 5; // Just finding next ride

            let totalTimeInvested = time + deadheadTime;
            let hourlyRate = (totalEarnings / totalTimeInvested) * 60;

            // Verdict Logic
            let verdict = "";
            let colorClass = "";
            let reason = "";

            if (hourlyRate < 15) {
                verdict = "DECLINE üõë";
                colorClass = "text-rose-600";
                reason = "You are losing money. The return trip (deadhead) destroys your hourly rate.";
            } else if (hourlyRate < 25) {
                verdict = "BORDERLINE ‚ö†Ô∏è";
                colorClass = "text-amber-500";
                reason = "Acceptable only if it gets you closer to home or a better zone.";
            } else {
                verdict = "ACCEPT ‚úÖ";
                colorClass = "text-emerald-600";
                reason = "Profitable trip! The earnings outweigh the return cost.";
            }

            // Update UI
            document.getElementById('calc-placeholder').classList.add('hidden');
            const resultDiv = document.getElementById('calc-result');
            resultDiv.classList.remove('hidden');
            resultDiv.classList.add('flex');

            document.getElementById('verdict-title').innerText = verdict;
            document.getElementById('verdict-title').className = `text-3xl font-black ${colorClass}`;
            document.getElementById('verdict-icon').innerText = verdict.includes('ACCEPT') ? "ü§ë" : (verdict.includes('DECLINE') ? "üõë" : "ü§î");

            document.getElementById('est-earnings').innerText = `$${totalEarnings.toFixed(2)}`;
            document.getElementById('est-deadhead').innerText = `${deadheadTime} mins`;
            document.getElementById('est-hourly').innerText = `$${hourlyRate.toFixed(0)}/hr`;
            document.getElementById('verdict-reason').innerText = reason;
        }

        // Init
        setArchetype('sprawl'); // Start with Sprawl
    </script>
</body>
</html>